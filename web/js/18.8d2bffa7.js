"use strict";(self["webpackChunkcanseo"]=self["webpackChunkcanseo"]||[]).push([[18],{7209:function(e,a,t){var s=t(9669),o=t.n(s);const n=o().create({baseURL:"https://canseo.site/api",headers:{"Content-type":"application/json"}});n.interceptors.request.use((e=>{const a=localStorage.getItem("Authorization");return a&&(e.headers.common["Authorization"]=`${a}`),e}),(e=>Promise.reject(e))),a.Z=n},3336:function(e,a,t){var s=t(7209);const o={getAll(){return s.Z.get("/reservas")},get(e){return s.Z.get(`/reservas/${e}`)},create(e){return s.Z.post("/reservas",e)},update(e,a){return s.Z.put(`/reservas/${e}`,a)},delete(e){return s.Z.delete(`/reservas/${e}`)},deleteAll(){return s.Z.delete("/reservas")},getReservasByUserId(e){return s.Z.get(`/reservas/user/${e}`)},getReservasByPaseadorId(e){return s.Z.get(`/reservas/paseador/${e}`)},getReservasFiltradas(e,a){return s.Z.get(`/reservas/filtered/${e}?fecha=${a.fecha}&hora=${a.hora}&estado=${a.estado}`)},getReservasFiltradasPaseador(e,a){return s.Z.get(`/reservas/filteredPaseador/${e}?fecha=${a.fecha}&hora=${a.hora}&estado=${a.estado}`)},updateEstado(e,a){return s.Z.patch(`/reservas/${e}/estado`,{estado:a})}};a.Z=o},5018:function(e,a,t){t.r(a),t.d(a,{default:function(){return B}});var s=t(6252),o=t(3577),n=t(9963);const r=e=>((0,s.dD)("data-v-3139c838"),e=e(),(0,s.Cn)(),e),i={class:"general"},l=r((()=>(0,s._)("h1",null,"Mis reservas",-1))),c={class:"filter-section"},d={class:"form-row"},u=r((()=>(0,s._)("label",{class:"fecha",for:"fecha"},"Fecha:",-1))),v={class:"form-row"},h=r((()=>(0,s._)("label",{class:"hora",for:"hora"},"Hora:",-1))),m=r((()=>(0,s._)("option",{value:""},"Todos",-1))),f=r((()=>(0,s._)("option",{value:"7:00"},"7:00 - 13:00",-1))),p=r((()=>(0,s._)("option",{value:"13:00"},"13:00 - 17:00",-1))),g=r((()=>(0,s._)("option",{value:"18:00"},"18:00 - 22:00",-1))),_=[m,f,p,g],b={class:"form-row"},w=r((()=>(0,s._)("label",{class:"estado",for:"estado"},"Estado:",-1))),C=r((()=>(0,s._)("option",{value:""},"Todos",-1))),M=r((()=>(0,s._)("option",{value:"Pendiente"},"Pendiente",-1))),k=r((()=>(0,s._)("option",{value:"Terminado"},"Terminado",-1))),Z=r((()=>(0,s._)("option",{value:"Cancelado"},"Cancelado",-1))),R=[C,M,k,Z],$={class:"form-row row-buttons"},D=r((()=>(0,s._)("button",{type:"submit"},"Filtrar",-1))),y={class:"img-reserva"},z=["src","alt"],U={class:"div-cancelar"},F=["onClick"],W={key:1};function I(e,a,t,r,m,f){const p=(0,s.up)("NavCliente");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(p),(0,s._)("div",i,[l,m.notification?((0,s.wg)(),(0,s.iD)("div",{key:0,class:(0,o.C_)(["notification",f.notificationClass])},(0,o.zw)(e.message),3)):(0,s.kq)("",!0),(0,s._)("div",c,[(0,s._)("form",{onSubmit:a[4]||(a[4]=(0,n.iM)(((...e)=>f.fetchReservasFiltradas&&f.fetchReservasFiltradas(...e)),["prevent"]))},[(0,s._)("div",d,[u,(0,s.wy)((0,s._)("input",{type:"date","onUpdate:modelValue":a[0]||(a[0]=e=>m.fecha=e),id:"fecha"},null,512),[[n.nr,m.fecha]])]),(0,s._)("div",v,[h,(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>m.hora=e),id:"hora"},_,512),[[n.bM,m.hora]])]),(0,s._)("div",b,[w,(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>m.estado=e),id:"estado"},R,512),[[n.bM,m.estado]])]),(0,s._)("div",$,[D,(0,s._)("button",{onClick:a[3]||(a[3]=(...e)=>f.clearFilters&&f.clearFilters(...e))},"Borrar Filtros")])],32)]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(m.reservas,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id,class:"reserva-item"},[(0,s._)("div",y,[(0,s._)("p",null,"Fecha: "+(0,o.zw)(f.formatDate(e.fecha)),1),(0,s._)("img",{class:"img-perfil",src:f.getImageUrl(e.foto_perfil||"/uploads/default-profile.png"),alt:e.nombre+" "+e.apellido},null,8,z)]),(0,s._)("p",null,"Comienzo rango horario: "+(0,o.zw)(e.hora),1),(0,s._)("p",null,"Paseador: "+(0,o.zw)(e.nombre)+" "+(0,o.zw)(e.apellido),1),(0,s._)("div",U,[(0,s._)("p",null,"Estado: "+(0,o.zw)(e.estado),1),"Pendiente"===e.estado&&f.cancelar(e)?((0,s.wg)(),(0,s.iD)("button",{key:0,onClick:a=>f.cambiarEstado(e.id,"Cancelado")},"Cancelar",8,F)):((0,s.wg)(),(0,s.iD)("span",W))])])))),128))])],64)}var P=t(3336),Y=t(7239),E=t(381),N=t.n(E),S=t(1012),H={name:"ReservasCliente",components:{NavCliente:S.Z},data(){return{reservas:[],paseadores:[],notification:null,fecha:"",hora:"",estado:""}},mounted(){this.fetchReservas(),this.fetchNotification()},methods:{fetchReservas(){const e=Y.Z.getters.getClientId;P.Z.getReservasByUserId(e).then((e=>{this.reservas=e.data.reverse()})).catch((e=>{console.log(e)}))},fetchReservasFiltradas(){const e=Y.Z.getters.getClientId;P.Z.getReservasFiltradas(e,{fecha:this.fecha,hora:this.hora,estado:this.estado}).then((e=>{this.reservas=e.data.reverse()})).catch((e=>{console.log(e)}))},clearFilters(){this.fecha="",this.hora="",this.estado="",this.fetchReservas()},formatDate(e){return N()(e).format("DD/MM/YYYY")},fetchNotification(){this.notification=Y.Z.state.notification,this.message=Y.Z.state.message,setTimeout((()=>{this.notification=null,this.message=null,Y.Z.commit("setNotification",null),Y.Z.commit("setMessage",null)}),8e3)},cambiarEstado(e,a){P.Z.updateEstado(e,a).then((e=>{this.fetchReservas(),console.log(e)})).catch((e=>{console.log("Error al actualizar el estado de reserva:",e)}))},cancelar(e){const a=N()(`${e.fecha} ${e.hora}`,"YYYY-MM-DD HH:mm"),t=N()(),s=t.clone().add(24,"hours");return a.isAfter(s)},getImageUrl(e){if(e){const a=e.replace("vue","").replace("public",""),t=window.location.origin;return`${t}/${a}`}}},computed:{notificationClass(){return{"notification-success":"success"===this.notification,"notification-error":"error"===this.notification}}}},T=t(3744);const A=(0,T.Z)(H,[["render",I],["__scopeId","data-v-3139c838"]]);var B=A},1012:function(e,a,t){t.d(a,{Z:function(){return W}});var s=t(6252),o=t(3577);const n=e=>((0,s.dD)("data-v-2293848b"),e=e(),(0,s.Cn)(),e),r={key:0},i={class:"menu-mobile-box"},l=n((()=>(0,s._)("img",{src:"https://canseo-vue.vercel.app/uploads/CanSeo.png",alt:"CanSeo"},null,-1))),c=n((()=>(0,s._)("img",{class:"icon",src:"https://canseo-vue.vercel.app/uploads/imagen-hamburguesa.png",alt:"Menú Hamburguesa"},null,-1))),d=[c],u=n((()=>(0,s._)("img",{class:"icon",src:"https://canseo-vue.vercel.app/uploads/imagen-cerrar.png",alt:"Cerrar Menú"},null,-1))),v=[u],h={class:"navbar-nav mr-auto"},m={class:"nav-item"},f={class:"nav-item"},p={class:"nav-item"},g={class:"navbar-nav"},_={class:"nav-item"},b={key:1,class:"navbar navbar-expand navbar-light"},w=n((()=>(0,s._)("img",{src:"https://canseo-vue.vercel.app/uploads/CanSeo.png",alt:"CanSeo"},null,-1))),C={class:"navbar-nav mr-auto mtop-10"},M={class:"nav-item"},k={class:"nav-item"},Z={class:"nav-item"},R={class:"navbar-nav mtop-10"},$={class:"nav-item"};function D(e,a,t,n,c,u){const D=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",null,[c.isMobile?((0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",i,[(0,s.Wm)(D,{to:"/",class:"navbar-brand img-canseo-mobile"},{default:(0,s.w5)((()=>[l])),_:1}),(0,s._)("div",{onClick:a[0]||(a[0]=(...e)=>u.toggleMobileMenu&&u.toggleMobileMenu(...e)),class:"menu-button"},d)]),(0,s._)("div",{class:(0,o.C_)({"mobile-menu":!0,open:c.isMobileMenuOpen})},[(0,s._)("div",{onClick:a[1]||(a[1]=(...e)=>u.toggleMobileMenu&&u.toggleMobileMenu(...e)),class:"close-button"},v),(0,s._)("div",h,[(0,s._)("li",m,[(0,s.Wm)(D,{to:"/",class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Reservar")])),_:1})]),(0,s._)("li",f,[(0,s.Wm)(D,{to:"/reservas-cliente",class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Reservas")])),_:1})]),(0,s._)("li",p,[(0,s.Wm)(D,{to:"/perfil/cliente",class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Perfil")])),_:1})])]),(0,s._)("div",g,[(0,s._)("li",_,[(0,s._)("a",{class:"nav-link",onClick:a[2]||(a[2]=(...e)=>u.logout&&u.logout(...e))},"Cerrar sesión")])])],2)])):((0,s.wg)(),(0,s.iD)("nav",b,[(0,s.Wm)(D,{to:"/",class:"navbar-brand"},{default:(0,s.w5)((()=>[w])),_:1}),(0,s._)("div",C,[(0,s._)("li",M,[(0,s.Wm)(D,{to:"/",class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Reservar")])),_:1})]),(0,s._)("li",k,[(0,s.Wm)(D,{to:"/reservas-cliente",class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Reservas")])),_:1})]),(0,s._)("li",Z,[(0,s.Wm)(D,{to:"/perfil/cliente",class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Perfil")])),_:1})])]),(0,s._)("div",R,[(0,s._)("li",$,[(0,s._)("a",{class:"nav-link",onClick:a[3]||(a[3]=(...e)=>u.logout&&u.logout(...e))},"Cerrar sesión")])])]))])}t(7658);var y=t(7239),z={name:"NavCliente",data(){return{isMobileMenuOpen:!1,isMobile:window.innerWidth<=768}},created(){window.addEventListener("resize",this.handleResize)},unmounted(){window.removeEventListener("resize",this.handleResize)},methods:{logout(){y.Z.dispatch("logout"),y.Z.commit("setNotification","success"),y.Z.commit("setMessage","Sesión cerrada correctamente"),this.$router.push("/login/clientes"),setTimeout((()=>{y.Z.commit("setNotification",null),y.Z.commit("setMessage",null)}),1e4)},handleResize(){this.isMobile=window.innerWidth<=768},toggleMobileMenu(){this.isMobileMenuOpen=!this.isMobileMenuOpen}}},U=t(3744);const F=(0,U.Z)(z,[["render",D],["__scopeId","data-v-2293848b"]]);var W=F}}]);
//# sourceMappingURL=18.8d2bffa7.js.map