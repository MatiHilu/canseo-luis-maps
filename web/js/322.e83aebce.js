"use strict";(self["webpackChunkcanseo"]=self["webpackChunkcanseo"]||[]).push([[322],{7209:function(e,a,s){var o=s(9669),t=s.n(o);const n=t().create({baseURL:"https://canseo.site/api/api",headers:{"Content-type":"application/json"}});n.interceptors.request.use((e=>{const a=localStorage.getItem("Authorization");return a&&(e.headers.common["Authorization"]=`${a}`),e}),(e=>Promise.reject(e))),a.Z=n},3336:function(e,a,s){var o=s(7209);const t={getAll(){return o.Z.get("/reservas")},get(e){return o.Z.get(`/reservas/${e}`)},create(e){return o.Z.post("/reservas",e)},update(e,a){return o.Z.put(`/reservas/${e}`,a)},delete(e){return o.Z.delete(`/reservas/${e}`)},deleteAll(){return o.Z.delete("/reservas")},getReservasByUserId(e){return o.Z.get(`/reservas/user/${e}`)},getReservasByPaseadorId(e){return o.Z.get(`/reservas/paseador/${e}`)},getReservasFiltradas(e,a){return o.Z.get(`/reservas/filtered/${e}?fecha=${a.fecha}&hora=${a.hora}&estado=${a.estado}`)},getReservasFiltradasPaseador(e,a){return o.Z.get(`/reservas/filteredPaseador/${e}?fecha=${a.fecha}&hora=${a.hora}&estado=${a.estado}`)},updateEstado(e,a){return o.Z.patch(`/reservas/${e}/estado`,{estado:a})}};a.Z=t},4360:function(e,a,s){s.d(a,{Z:function(){return $}});var o=s(6252),t=s(3577);const n=e=>((0,o.dD)("data-v-c2526fdc"),e=e(),(0,o.Cn)(),e),r={key:0},i={class:"menu-mobile-box"},l=n((()=>(0,o._)("img",{src:"https://canseo-vue.vercel.app/uploads/CanSeo-Paseador.png",alt:"CanSeo Paseador"},null,-1))),c=n((()=>(0,o._)("img",{class:"icon",src:"https://canseo-vue.vercel.app/uploads/imagen-hamburguesa.png",alt:"Menú Hamburguesa"},null,-1))),d=[c],u=n((()=>(0,o._)("img",{class:"icon",src:"https://canseo-vue.vercel.app/uploads/imagen-cerrar.png",alt:"Cerrar Menú"},null,-1))),p=[u],v={class:"navbar-nav mr-auto"},m={class:"nav-item"},g={class:"nav-item"},h={class:"navbar-nav"},f={class:"nav-item"},_={key:1,class:"navbar navbar-expand navbar-light"},w=n((()=>(0,o._)("img",{src:"https://canseo-vue.vercel.app/uploads/CanSeo-Paseador.png",alt:"CanSeo"},null,-1))),b={class:"navbar-nav mr-auto mtop-10"},M={class:"nav-item"},k={class:"nav-item"},C={class:"navbar-nav mtop-10"},Z={class:"nav-item"};function D(e,a,s,n,c,u){const D=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[c.isMobile?((0,o.wg)(),(0,o.iD)("div",r,[(0,o._)("div",i,[(0,o.Wm)(D,{to:"/reservas-paseador",class:"navbar-brand img-canseo-mobile"},{default:(0,o.w5)((()=>[l])),_:1}),(0,o._)("div",{onClick:a[0]||(a[0]=(...e)=>u.toggleMobileMenu&&u.toggleMobileMenu(...e)),class:"menu-button"},d)]),(0,o._)("div",{class:(0,t.C_)({"mobile-menu":!0,open:c.isMobileMenuOpen})},[(0,o._)("div",{onClick:a[1]||(a[1]=(...e)=>u.toggleMobileMenu&&u.toggleMobileMenu(...e)),class:"close-button"},p),(0,o._)("div",v,[(0,o._)("li",m,[(0,o.Wm)(D,{to:"/reservas-paseador",class:"nav-link"},{default:(0,o.w5)((()=>[(0,o.Uk)("Mis paseos")])),_:1})]),(0,o._)("li",g,[(0,o.Wm)(D,{to:"/perfil/paseador",class:"nav-link"},{default:(0,o.w5)((()=>[(0,o.Uk)("Perfil")])),_:1})])]),(0,o._)("div",h,[(0,o._)("li",f,[(0,o._)("a",{class:"nav-link",onClick:a[2]||(a[2]=(...e)=>u.logout&&u.logout(...e))},"Cerrar sesión")])])],2)])):((0,o.wg)(),(0,o.iD)("nav",_,[(0,o.Wm)(D,{to:"/reservas-paseador",class:"navbar-brand"},{default:(0,o.w5)((()=>[w])),_:1}),(0,o._)("div",b,[(0,o._)("li",M,[(0,o.Wm)(D,{to:"/reservas-paseador",class:"nav-link"},{default:(0,o.w5)((()=>[(0,o.Uk)("Mis paseos")])),_:1})]),(0,o._)("li",k,[(0,o.Wm)(D,{to:"/perfil/paseador",class:"nav-link"},{default:(0,o.w5)((()=>[(0,o.Uk)("Perfil")])),_:1})])]),(0,o._)("div",C,[(0,o._)("li",Z,[(0,o._)("a",{class:"nav-link",onClick:a[3]||(a[3]=(...e)=>u.logout&&u.logout(...e))},"Cerrar sesión")])])]))])}s(7658);var P=s(7239),z={name:"NavPaseador",data(){return{isMobileMenuOpen:!1,isMobile:window.innerWidth<=768}},created(){window.addEventListener("resize",this.handleResize)},unmounted(){window.removeEventListener("resize",this.handleResize)},methods:{logout(){P.Z.dispatch("logout"),P.Z.commit("setNotification","success"),P.Z.commit("setMessage","Sesión cerrada correctamente"),this.$router.push("/login/paseadores"),setTimeout((()=>{P.Z.commit("setNotification",null),P.Z.commit("setMessage",null)}),1e4)},handleResize(){this.isMobile=window.innerWidth<=768},toggleMobileMenu(){this.isMobileMenuOpen=!this.isMobileMenuOpen}}},R=s(3744);const y=(0,R.Z)(z,[["render",D],["__scopeId","data-v-c2526fdc"]]);var $=y},1322:function(e,a,s){s.r(a),s.d(a,{default:function(){return B}});var o=s(6252),t=s(3577),n=s(9963);const r=e=>((0,o.dD)("data-v-9731bdc8"),e=e(),(0,o.Cn)(),e),i={class:"general"},l=r((()=>(0,o._)("h1",null,"Paseos reservados",-1))),c={class:"filter-section"},d={class:"form-row"},u=r((()=>(0,o._)("label",{class:"fecha",for:"fecha"},"Fecha:",-1))),p={class:"form-row"},v=r((()=>(0,o._)("label",{class:"hora",for:"hora"},"Hora:",-1))),m=r((()=>(0,o._)("option",{value:""},"Todos",-1))),g=r((()=>(0,o._)("option",{value:"7:00"},"7:00 - 13:00",-1))),h=r((()=>(0,o._)("option",{value:"13:00"},"13:00 - 17:00",-1))),f=r((()=>(0,o._)("option",{value:"18:00"},"18:00 - 22:00",-1))),_=[m,g,h,f],w={class:"form-row"},b=r((()=>(0,o._)("label",{class:"estado",for:"estado"},"Estado:",-1))),M=r((()=>(0,o._)("option",{value:""},"Todos",-1))),k=r((()=>(0,o._)("option",{value:"Pendiente"},"Pendiente",-1))),C=r((()=>(0,o._)("option",{value:"Terminado"},"Terminado",-1))),Z=r((()=>(0,o._)("option",{value:"Cancelado"},"Cancelado",-1))),D=[M,k,C,Z],P={class:"form-row row-buttons"},z=r((()=>(0,o._)("button",{type:"submit"},"Filtrar",-1))),R={class:"img-reserva"},y=["src","alt"],$={class:"map-container"},I=r((()=>(0,o._)("div",{id:"map"},null,-1))),F=["onClick","onTouchstart"],E=["onClick","disabled"],A={key:1},T={key:2};function U(e,a,s,r,m,g){const h=(0,o.up)("NavPaseador");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(h),(0,o._)("div",i,[l,m.notification?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,t.C_)(["notification",g.notificationClass])},(0,t.zw)(e.message),3)):(0,o.kq)("",!0),(0,o._)("div",c,[(0,o._)("form",{onSubmit:a[4]||(a[4]=(0,n.iM)(((...e)=>g.fetchReservasFiltradas&&g.fetchReservasFiltradas(...e)),["prevent"]))},[(0,o._)("div",d,[u,(0,o.wy)((0,o._)("input",{type:"date","onUpdate:modelValue":a[0]||(a[0]=e=>m.fecha=e),id:"fecha"},null,512),[[n.nr,m.fecha]])]),(0,o._)("div",p,[v,(0,o.wy)((0,o._)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>m.hora=e),id:"hora"},_,512),[[n.bM,m.hora]])]),(0,o._)("div",w,[b,(0,o.wy)((0,o._)("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>m.estado=e),id:"estado"},D,512),[[n.bM,m.estado]])]),(0,o._)("div",P,[z,(0,o._)("button",{onClick:a[3]||(a[3]=(...e)=>g.clearFilters&&g.clearFilters(...e))},"Borrar Filtros")])],32)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(m.reservas,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"reserva-item"},[(0,o._)("div",R,[(0,o._)("p",null,"Fecha: "+(0,t.zw)(g.formatDate(e.fecha)),1),(0,o._)("img",{class:"img-perfil",src:g.getImageUrl(e.foto_perfil||"/uploads/default-profile.png"),alt:e.nombre+" "+e.apellido},null,8,y)]),(0,o._)("p",null,"Hora: "+(0,t.zw)(e.hora),1),(0,o._)("p",null,"Cliente: "+(0,t.zw)(e.nombre)+" "+(0,t.zw)(e.apellido),1),(0,o._)("div",$,[(0,o._)("p",null,"Dirección: "+(0,t.zw)(e.direccion),1),I,(0,o._)("button",{onClick:a=>g.showDirections(e.direccion),onTouchstart:a=>g.showDirections(e.direccion)},"Ver cómo llegar",40,F)]),(0,o._)("p",null,"Perro: "+(0,t.zw)(e.nombre_perro)+" Raza: "+(0,t.zw)(e.nombre_raza),1),(0,o._)("p",null,"Estado: "+(0,t.zw)(e.estado),1),"Pendiente"===e.estado?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:a=>g.cambiarEstado(e.id,"Terminado"),disabled:!g.canMarkAsCompleted(e)},"Paseo terminado",8,E)):(0,o.kq)("",!0),"Terminado"===e.estado?((0,o.wg)(),(0,o.iD)("span",A)):(0,o.kq)("",!0),"Cancelado"===e.estado?((0,o.wg)(),(0,o.iD)("span",T)):(0,o.kq)("",!0)])))),128))])],64)}var S=s(3336),Y=s(7239),N=s(381),W=s.n(N),H=s(4360),O={name:"ReservasPaseador",components:{NavPaseador:H.Z},data(){return{reservas:[],notification:null,fecha:"",hora:"",estado:"",map:null}},mounted(){this.fetchReservas(),this.fetchNotification(),this.loadGoogleMapsAPI()},methods:{fetchReservas(){const e=Y.Z.getters.getClientId;S.Z.getReservasByPaseadorId(e).then((e=>{this.reservas=e.data.reverse()})).catch((e=>{console.log(e)}))},fetchReservasFiltradas(){const e=Y.Z.getters.getClientId;S.Z.getReservasFiltradasPaseador(e,{fecha:this.fecha,hora:this.hora,estado:this.estado}).then((e=>{console.log(e),this.reservas=e.data.reverse()})).catch((e=>{console.log(e)}))},clearFilters(){this.fecha="",this.hora="",this.estado="",this.fetchReservas()},cambiarEstado(e,a){S.Z.updateEstado(e,a).then((e=>{this.fetchReservas(),console.log(e)})).catch((e=>{console.log("Error al actualizar el estado de reserva:",e)}))},formatDate(e){return W()(e).format("DD/MM/YYYY")},canMarkAsCompleted(e){const a=W()(`${e.fecha} ${e.hora}`,"YYYY-MM-DD HH:mm"),s=W()(),o=a.clone().add(4,"hour");return s.isAfter(o)},fetchNotification(){this.notification=Y.Z.state.notification,this.message=Y.Z.state.message,setTimeout((()=>{this.notification=null,this.message=null,Y.Z.commit("setNotification",null),Y.Z.commit("setMessage",null)}),8e3)},getImageUrl(e){if(e){const a=e.replace("vue","").replace("public",""),s=window.location.origin;return`${s}/${a}`}},showDirections(e){const a=new window.google.maps.Geocoder,s=new window.google.maps.DirectionsService,o=new window.google.maps.DirectionsRenderer({map:null});a.geocode({address:e},((e,a)=>{if("OK"===a){const a=e[0].geometry.location;navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{const t=new window.google.maps.LatLng(e.coords.latitude,e.coords.longitude),n={origin:t,destination:a,travelMode:window.google.maps.TravelMode.DRIVING};s.route(n,((e,a)=>{"OK"===a&&(o.setDirections(e),o.setMap(this.map))}))}))}}))},loadGoogleMapsAPI(){const e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAolIlSEOimzlZRcQk8CX2Zep2GMtK3HVo&libraries=places&callback=initMap",e.async=!0,e.defer=!0,e.onload=this.initMap,document.head.appendChild(e)},initMap(){this.map=new window.google.maps.Map(document.getElementById("map"),{center:{lat:-34.397,lng:150.644},zoom:8})}},computed:{notificationClass(){return{"notification-success":"success"===this.notification,"notification-error":"error"===this.notification}}}},V=s(3744);const q=(0,V.Z)(O,[["render",U],["__scopeId","data-v-9731bdc8"]]);var B=q}}]);
//# sourceMappingURL=322.e83aebce.js.map