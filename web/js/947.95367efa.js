"use strict";(self["webpackChunkcanseo"]=self["webpackChunkcanseo"]||[]).push([[947],{7209:function(e,a,s){var o=s(9669),t=s.n(o);const r=t().create({baseURL:"https://canseo.site/api/api",headers:{"Content-type":"application/json"}});r.interceptors.request.use((e=>{const a=localStorage.getItem("Authorization");return a&&(e.headers.common["Authorization"]=`${a}`),e}),(e=>Promise.reject(e))),a.Z=r},3336:function(e,a,s){var o=s(7209);const t={getAll(){return o.Z.get("/reservas")},get(e){return o.Z.get(`/reservas/${e}`)},create(e){return o.Z.post("/reservas",e)},update(e,a){return o.Z.put(`/reservas/${e}`,a)},delete(e){return o.Z.delete(`/reservas/${e}`)},deleteAll(){return o.Z.delete("/reservas")},getReservasByUserId(e){return o.Z.get(`/reservas/user/${e}`)},getReservasByPaseadorId(e){return o.Z.get(`/reservas/paseador/${e}`)},getReservasFiltradas(e,a){return o.Z.get(`/reservas/filtered/${e}?fecha=${a.fecha}&hora=${a.hora}&estado=${a.estado}`)},getReservasFiltradasPaseador(e,a){return o.Z.get(`/reservas/filteredPaseador/${e}?fecha=${a.fecha}&hora=${a.hora}&estado=${a.estado}`)},updateEstado(e,a){return o.Z.patch(`/reservas/${e}/estado`,{estado:a})}};a.Z=t},4360:function(e,a,s){s.d(a,{Z:function(){return y}});var o=s(6252),t=s(3577);const r=e=>((0,o.dD)("data-v-c2526fdc"),e=e(),(0,o.Cn)(),e),n={key:0},i={class:"menu-mobile-box"},l=r((()=>(0,o._)("img",{src:"https://canseo-vue.vercel.app/uploads/CanSeo-Paseador.png",alt:"CanSeo Paseador"},null,-1))),c=r((()=>(0,o._)("img",{class:"icon",src:"https://canseo-vue.vercel.app/uploads/imagen-hamburguesa.png",alt:"Menú Hamburguesa"},null,-1))),d=[c],u=r((()=>(0,o._)("img",{class:"icon",src:"https://canseo-vue.vercel.app/uploads/imagen-cerrar.png",alt:"Cerrar Menú"},null,-1))),v=[u],m={class:"navbar-nav mr-auto"},p={class:"nav-item"},g={class:"nav-item"},h={class:"navbar-nav"},f={class:"nav-item"},_={key:1,class:"navbar navbar-expand navbar-light"},w=r((()=>(0,o._)("img",{src:"https://canseo-vue.vercel.app/uploads/CanSeo-Paseador.png",alt:"CanSeo"},null,-1))),b={class:"navbar-nav mr-auto mtop-10"},M={class:"nav-item"},k={class:"nav-item"},C={class:"navbar-nav mtop-10"},Z={class:"nav-item"};function D(e,a,s,r,c,u){const D=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[c.isMobile?((0,o.wg)(),(0,o.iD)("div",n,[(0,o._)("div",i,[(0,o.Wm)(D,{to:"/reservas-paseador",class:"navbar-brand img-canseo-mobile"},{default:(0,o.w5)((()=>[l])),_:1}),(0,o._)("div",{onClick:a[0]||(a[0]=(...e)=>u.toggleMobileMenu&&u.toggleMobileMenu(...e)),class:"menu-button"},d)]),(0,o._)("div",{class:(0,t.C_)({"mobile-menu":!0,open:c.isMobileMenuOpen})},[(0,o._)("div",{onClick:a[1]||(a[1]=(...e)=>u.toggleMobileMenu&&u.toggleMobileMenu(...e)),class:"close-button"},v),(0,o._)("div",m,[(0,o._)("li",p,[(0,o.Wm)(D,{to:"/reservas-paseador",class:"nav-link"},{default:(0,o.w5)((()=>[(0,o.Uk)("Mis paseos")])),_:1})]),(0,o._)("li",g,[(0,o.Wm)(D,{to:"/perfil/paseador",class:"nav-link"},{default:(0,o.w5)((()=>[(0,o.Uk)("Perfil")])),_:1})])]),(0,o._)("div",h,[(0,o._)("li",f,[(0,o._)("a",{class:"nav-link",onClick:a[2]||(a[2]=(...e)=>u.logout&&u.logout(...e))},"Cerrar sesión")])])],2)])):((0,o.wg)(),(0,o.iD)("nav",_,[(0,o.Wm)(D,{to:"/reservas-paseador",class:"navbar-brand"},{default:(0,o.w5)((()=>[w])),_:1}),(0,o._)("div",b,[(0,o._)("li",M,[(0,o.Wm)(D,{to:"/reservas-paseador",class:"nav-link"},{default:(0,o.w5)((()=>[(0,o.Uk)("Mis paseos")])),_:1})]),(0,o._)("li",k,[(0,o.Wm)(D,{to:"/perfil/paseador",class:"nav-link"},{default:(0,o.w5)((()=>[(0,o.Uk)("Perfil")])),_:1})])]),(0,o._)("div",C,[(0,o._)("li",Z,[(0,o._)("a",{class:"nav-link",onClick:a[3]||(a[3]=(...e)=>u.logout&&u.logout(...e))},"Cerrar sesión")])])]))])}s(7658);var P=s(7239),R={name:"NavPaseador",data(){return{isMobileMenuOpen:!1,isMobile:window.innerWidth<=768}},created(){window.addEventListener("resize",this.handleResize)},unmounted(){window.removeEventListener("resize",this.handleResize)},methods:{logout(){P.Z.dispatch("logout"),P.Z.commit("setNotification","success"),P.Z.commit("setMessage","Sesión cerrada correctamente"),this.$router.push("/login/paseadores"),setTimeout((()=>{P.Z.commit("setNotification",null),P.Z.commit("setMessage",null)}),1e4)},handleResize(){this.isMobile=window.innerWidth<=768},toggleMobileMenu(){this.isMobileMenuOpen=!this.isMobileMenuOpen}}},$=s(3744);const z=(0,$.Z)(R,[["render",D],["__scopeId","data-v-c2526fdc"]]);var y=z},4947:function(e,a,s){s.r(a),s.d(a,{default:function(){return V}});var o=s(6252),t=s(3577),r=s(9963);const n=e=>((0,o.dD)("data-v-17f9da36"),e=e(),(0,o.Cn)(),e),i={class:"general"},l=n((()=>(0,o._)("h1",null,"Paseos reservados",-1))),c={class:"filter-section"},d={class:"form-row"},u=n((()=>(0,o._)("label",{class:"fecha",for:"fecha"},"Fecha:",-1))),v={class:"form-row"},m=n((()=>(0,o._)("label",{class:"hora",for:"hora"},"Hora:",-1))),p=n((()=>(0,o._)("option",{value:""},"Todos",-1))),g=n((()=>(0,o._)("option",{value:"7:00"},"7:00 - 13:00",-1))),h=n((()=>(0,o._)("option",{value:"13:00"},"13:00 - 17:00",-1))),f=n((()=>(0,o._)("option",{value:"18:00"},"18:00 - 22:00",-1))),_=[p,g,h,f],w={class:"form-row"},b=n((()=>(0,o._)("label",{class:"estado",for:"estado"},"Estado:",-1))),M=n((()=>(0,o._)("option",{value:""},"Todos",-1))),k=n((()=>(0,o._)("option",{value:"Pendiente"},"Pendiente",-1))),C=n((()=>(0,o._)("option",{value:"Terminado"},"Terminado",-1))),Z=n((()=>(0,o._)("option",{value:"Cancelado"},"Cancelado",-1))),D=[M,k,C,Z],P={class:"form-row row-buttons"},R=n((()=>(0,o._)("button",{type:"submit"},"Filtrar",-1))),$={class:"img-reserva"},z=["src","alt"],y={class:"map-container"},F=n((()=>(0,o._)("div",{id:"map"},null,-1))),I=["onClick","onTouchstartPassive"],T=["onClick","disabled"],U={key:1},Y={key:2};function E(e,a,s,n,p,g){const h=(0,o.up)("NavPaseador");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(h),(0,o._)("div",i,[l,p.notification?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,t.C_)(["notification",g.notificationClass])},(0,t.zw)(e.message),3)):(0,o.kq)("",!0),(0,o._)("div",c,[(0,o._)("form",{onSubmit:a[4]||(a[4]=(0,r.iM)(((...e)=>g.fetchReservasFiltradas&&g.fetchReservasFiltradas(...e)),["prevent"]))},[(0,o._)("div",d,[u,(0,o.wy)((0,o._)("input",{type:"date","onUpdate:modelValue":a[0]||(a[0]=e=>p.fecha=e),id:"fecha"},null,512),[[r.nr,p.fecha]])]),(0,o._)("div",v,[m,(0,o.wy)((0,o._)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>p.hora=e),id:"hora"},_,512),[[r.bM,p.hora]])]),(0,o._)("div",w,[b,(0,o.wy)((0,o._)("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>p.estado=e),id:"estado"},D,512),[[r.bM,p.estado]])]),(0,o._)("div",P,[R,(0,o._)("button",{onClick:a[3]||(a[3]=(...e)=>g.clearFilters&&g.clearFilters(...e))},"Borrar Filtros")])],32)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(p.reservas,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"reserva-item"},[(0,o._)("div",$,[(0,o._)("p",null,"Fecha: "+(0,t.zw)(g.formatDate(e.fecha)),1),(0,o._)("img",{class:"img-perfil",src:g.getImageUrl(e.foto_perfil||"/uploads/default-profile.png"),alt:e.nombre+" "+e.apellido},null,8,z)]),(0,o._)("p",null,"Hora: "+(0,t.zw)(e.hora),1),(0,o._)("p",null,"Cliente: "+(0,t.zw)(e.nombre)+" "+(0,t.zw)(e.apellido),1),(0,o._)("div",y,[(0,o._)("p",null,"Dirección: "+(0,t.zw)(e.direccion),1),F,(0,o._)("button",{onClick:a=>g.showDirections(e.direccion),onTouchstartPassive:a=>g.showDirections(e.direccion)},"Ver cómo llegar",40,I)]),(0,o._)("p",null,"Perro: "+(0,t.zw)(e.nombre_perro)+" Raza: "+(0,t.zw)(e.nombre_raza),1),(0,o._)("p",null,"Estado: "+(0,t.zw)(e.estado),1),"Pendiente"===e.estado?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:a=>g.cambiarEstado(e.id,"Terminado"),disabled:!g.canMarkAsCompleted(e)},"Paseo terminado",8,T)):(0,o.kq)("",!0),"Terminado"===e.estado?((0,o.wg)(),(0,o.iD)("span",U)):(0,o.kq)("",!0),"Cancelado"===e.estado?((0,o.wg)(),(0,o.iD)("span",Y)):(0,o.kq)("",!0)])))),128))])],64)}var N=s(3336),W=s(7239),S=s(381),A=s.n(S),H=s(4360),O={name:"ReservasPaseador",components:{NavPaseador:H.Z},data(){return{reservas:[],notification:null,fecha:"",hora:"",estado:""}},mounted(){this.fetchReservas(),this.fetchNotification()},methods:{fetchReservas(){const e=W.Z.getters.getClientId;N.Z.getReservasByPaseadorId(e).then((e=>{this.reservas=e.data.reverse()})).catch((e=>{console.log(e)}))},fetchReservasFiltradas(){const e=W.Z.getters.getClientId;N.Z.getReservasFiltradasPaseador(e,{fecha:this.fecha,hora:this.hora,estado:this.estado}).then((e=>{console.log(e),this.reservas=e.data.reverse()})).catch((e=>{console.log(e)}))},clearFilters(){this.fecha="",this.hora="",this.estado="",this.fetchReservas()},cambiarEstado(e,a){N.Z.updateEstado(e,a).then((e=>{this.fetchReservas(),console.log(e)})).catch((e=>{console.log("Error al actualizar el estado de reserva:",e)}))},formatDate(e){return A()(e).format("DD/MM/YYYY")},canMarkAsCompleted(e){const a=A()(`${e.fecha} ${e.hora}`,"YYYY-MM-DD HH:mm"),s=A()(),o=a.clone().add(4,"hour");return s.isAfter(o)},fetchNotification(){this.notification=W.Z.state.notification,this.message=W.Z.state.message,setTimeout((()=>{this.notification=null,this.message=null,W.Z.commit("setNotification",null),W.Z.commit("setMessage",null)}),8e3)},getImageUrl(e){if(e){const a=e.replace("vue","").replace("public",""),s=window.location.origin;return`${s}/${a}`}},showDirections(e){const a=new window.google.maps.Geocoder,s=new window.google.maps.DirectionsService,o=new window.google.maps.DirectionsRenderer({map:this.map});a.geocode({address:e},((e,a)=>{if("OK"===a){const a=e[0].geometry.location;navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{const t=new window.google.maps.LatLng(e.coords.latitude,e.coords.longitude),r={origin:t,destination:a,travelMode:window.google.maps.TravelMode.DRIVING};s.route(r,((e,a)=>{"OK"===a&&o.setDirections(e)}))}))}}))}},computed:{notificationClass(){return{"notification-success":"success"===this.notification,"notification-error":"error"===this.notification}}}},q=s(3744);const L=(0,q.Z)(O,[["render",E],["__scopeId","data-v-17f9da36"]]);var V=L}}]);
//# sourceMappingURL=947.95367efa.js.map